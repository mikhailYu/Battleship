(()=>{"use strict";var t={d:(e,a)=>{for(var n in a)t.o(a,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:a[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{aT:()=>a,S8:()=>n,nS:()=>o});const a={player1:{gameBoardData:[],domData:[],shipData:[]},player2:{gameBoardData:[],domData:[],shipData:[]},globalData:{currentPlacedShipID:0}};let n="";function o(){a.globalData.currentPlacedShipID=0}const i=function(){return{setTiles:function(t){function e(e){return{player:t,index:a[t].gameBoardData.length,position:e,occupied:!1,shipOccuping:null,shot:!1,getTile:()=>position,updateTileOccupied(t){a[t].domData[this.index].classList.add("occupied")},markTileShot(e){const n=a[t].domData[this.index];this.shot=!0,n.classList.remove("occupied"),1==e?n.classList.add("hit"):n.classList.add("missed")}}}for(let n=1;n<=10;n++)for(let o=1;o<=10;o++){let i=new e({xPos:o,yPos:n});a[t].gameBoardData.push(i)}}}},r=document.querySelector(".bottomGameBoardCont"),l=document.querySelector(".rotateTileBox"),s=document.querySelector(".rotateButton");let c,p=0,u=!1;function h(){r.style.display="none",s.style.display="none"}function d(){let t=a.globalData.currentPlacedShipID;return c={length:a.player1.shipData[t].length,ship:a.player1.shipData[t],shipId:t},c}function y(t,e){!function(t){let e=0;return a[t].shipData.forEach((t=>{1==t.placed&&e++})),5===e}(t)?(function(t){a.globalData.currentPlacedShipID=t}(e),function(){for(;l.firstChild;)l.removeChild(l.firstChild);!function(){d(),u&&(c.ship.axis="horizontal");for(let t=0;t<c.length;t++){let t=document.createElement("div");t.classList.add("rotateTile"),l.appendChild(t)}}()}()):(g("player1"),g("player2"),h(),O="player1 turn",x(n+"'s turn"))}function f(t,o){let i;i="player1 turn"!==O||"player1"!=o.player,i&&(0==o.shot&&1==o.occupied?function(){let e=a[t].shipData.findIndex((t=>t.shipName===o.shipOccuping));a[t].shipData[e].shipHit(),o.markTileShot(!0),function(t){let e,o=a[t].shipData,i=0;o.forEach((t=>{1==t.sunk&&i++})),i>=5?(e="player1"==t?"player2":"player1",function(t){let e="";O="end",g("player2"),"player1"===t?(P("player2"),e=n):"player2"===t&&(P("player1"),e="Computer"),x(e+" wins!")}(e)):N()}(t)}():0==o.shot&&(o.markTileShot(!1),e.lastShot=" has missed... ",N()))}s.addEventListener("click",(function(){d(),u=0==u,p+=90;let t="rotate("+p+"deg)";l.style.transform=t,"vertical"===c.ship.axis?c.ship.axis="horizontal":"horizontal"===c.ship.axis&&(c.ship.axis="vertical")}));let m=document.querySelector(".inGameNotif");function D(t){const e=document.querySelector(".gameBoardsCont"),n=document.createElement("div");n.classList.add("gameBoardOuter"),e.appendChild(n),a[t].gameBoardData.forEach((function(e,o){const i=document.createElement("div");i.classList.add("tileSpace"),"player2"===t&&i.classList.add("opponent"),i.addEventListener("click",(()=>{!function(t,e,n){"placingShips"===O&&"player1"===e?function(t,e){let n=a.globalData.currentPlacedShipID;(function(t){let e=a[t.player].gameBoardData[t.tileID],n=[];return!(!function(){return"vertical"===t.shipAxis?a("yPos"):a("xPos");function a(a){return!(e.position[a]+(t.shipLength-1)>10||(function(){let a=e.position.xPos,i=e.position.yPos;for(let e=0;e<t.shipLength;e++)n.push(o(a,i)),"vertical"==t.shipAxis?i++:a++}(),0))}}()||!function(){let e=!1;return n.forEach((n=>function(n){let i=a[t.player].gameBoardData[n].position.yPos-1,r=a[t.player].gameBoardData[n].position.xPos-1;for(let n=r;n<r+3;n++)for(let r=i;r<i+3;r++)1==a[t.player].gameBoardData[o(n,r)].occupied&&(e=!0)}(n))),0==e}()||(n.forEach((e=>function(e){let n=a[t.player].gameBoardData[e],o=a[t.player].shipData[t.currentShipID];n.occupied=!0,n.updateTileOccupied(t.player),n.shipOccuping=o.shipName,o.placed=!0}(e))),0));function o(e,n){return e<=0&&(e=1),n<=0&&(n=1),e>10&&(e=10),n>10&&(n=10),a[t.player].gameBoardData.filter((t=>t.position.xPos===e&&t.position.yPos===n))[0].index}})({player:t,tileID:e,currentShipID:n,shipLength:a[t].shipData[n].length,shipAxis:a[t].shipData[n].axis})&&function(t){let e=a.globalData.currentPlacedShipID;e++,y(t,e)}(t)}(e,n):"player1 turn"===O&&f("player2",t)}(e,t,o)})),n.appendChild(i),a[t].domData.push(i)}))}function g(t){a[t].domData.forEach((t=>t.classList.toggle("active")))}function x(t){m.style.transform="scale(0)",setTimeout((()=>{m.textContent=t,m.style.transform="scale(1)"}),w/8)}function S(t){let a,o;"player1"===t?(a=n,o="Computer"):(a="Computer",o=n),x(a+e.lastShot+o+"'s turn.")}function P(t){let e=a[t].domData,n=Promise.resolve();e.forEach((t=>{n=n.then((function(){return t.classList.add("dead"),new Promise((function(t){setTimeout(t,10)}))}))}))}function B(t,a){return{shipName:t,length:a,sunk:!1,placed:!1,position:[],axis:"vertical",health:a,shipHit(){this.health--,this.isSunk()},isSunk(){this.health<=0?this.sunk=!0:this.sunk=!1,this.health<=0?(this.sunk=!0,e.lastShot=" has sunk the "+this.shipName+"!!! "):(this.sunk=!1,e.lastShot=" has hit the "+this.shipName+"! ")}}}function v(){let t=a.player2.shipData,e=[];function n(t){let o=function(){return{x:t(),y:t()};function t(){return Math.floor(9*Math.random()+1)}}(),i=Math.floor(9*Math.random()+1)>4?"horizontal":"vertical";t.axis=i;let r=function(t){let e=l(t.x,t.y);return a.player2.gameBoardData[e]}(o);function l(t,e){return t<=0&&(t=1),e<=0&&(e=1),t>10&&(t=10),e>10&&(e=10),a.player2.gameBoardData.filter((a=>a.position.xPos===t&&a.position.yPos===e))[0].index}e=[],function(t,n,o){return!(!function(t,a,n){return"vertical"===t.axis?o("yPos"):o("xPos");function o(a){return!(n.position[a]+(t.length-1)>10||(function(t,a,n){let o=n.position.xPos,i=n.position.yPos;for(let a=0;a<t.length;a++)e.push(l(o,i)),"vertical"==t.axis?i++:o++}(t,0,n),0))}}(t,0,o)||!function(t,n,o){let i=!1;return e.forEach((t=>function(t){let e=a.player2.gameBoardData[t].position.yPos-1,n=a.player2.gameBoardData[t].position.xPos-1;for(let t=n;t<n+3;t++)for(let n=e;n<e+3;n++)1==a.player2.gameBoardData[l(t,n)].occupied&&(i=!0)}(t))),0==i}()||(e.forEach((e=>function(t,e){let n=a.player2.gameBoardData[t];n.occupied=!0,n.shipOccuping=e.shipName,e.placed=!0}(e,t))),0))}(t,0,r)||function(t){n(t)}(t)}t.forEach((t=>n(t)))}let T,b=!1,E=0;function C(){return Math.floor(10*Math.random())}const L=document.querySelector(".playerNameCont"),k=document.querySelector(".nameConfirmBtn"),I=document.getElementById("nameInputForm");k.addEventListener("click",(function(){let t=I.value;""!==t&&t&&(n=t,L.style.display="none",g("player1"),M("player1"),M("player2"),r.style.display="flex",s.style.display="flex",l.style.display)}));let O="",w=3e3;function M(t){O="placingShips",function(t){const e=new B("Carrier",5),n=new B("Battleship",4),o=new B("Cruiser",3),i=new B("Submarine",3),r=new B("Destroyer",2);a[t].shipData.push(e,n,o,i,r)}(t),o();let e=a.globalData.currentPlacedShipID;"player1"==t?y(t,e):v()}function N(){"player1 turn"==O?(S("player1"),g("player2"),O="player2 turn",setTimeout((()=>{!function(){let t,e;function n(){t=Math.floor(99*Math.random()),e=a.player1.gameBoardData[t]}function o(){n(),i()}function i(){1==e.shot?o():r()}function r(){E=0,f("player1",e),1==e.occupied?(T=e,b=!0):b=!1}0==b?(n(),i()):function n(){let i=T.position.xPos,l=T.position.yPos;function s(s,c){var p,u;s>10?"x"==c?i=9:l=9:s<1&&("x"==c?i=2:l=2),p=i,u=l,t=a.player1.gameBoardData.filter((t=>t.position.xPos===p&&t.position.yPos===u))[0].index,e=a.player1.gameBoardData[t],1==e.shot?(E++,E<10?n():o()):r()}C()>5?(C()>5?i++:i--,s(i,"x")):(0==C()?l++:l--,s(l,"y"))}()}()}),w)):(S("player2"),O="player1 turn",setTimeout((()=>{g("player2")}),w/2))}!function(){O="initializing";const t=new i;t.setTiles("player1"),D("player1"),t.setTiles("player2"),D("player2"),h(),L.style.display="flex"}()})();